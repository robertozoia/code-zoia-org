<!DOCTYPE html>
<html><head>
    
    
    <title>
        Ubuntu 16.04 and Python 3.6&#43;
    </title>
    
    <meta charset="utf-8">
    <meta name="generator" content="Hugo 0.91.2" />
     <meta property="og:title" content="Ubuntu 16.04 and Python 3.6&#43;" />
<meta property="og:description" content="I was recently upgrading a system from Django 2.2 to 3.2. Django 3.2 requires Python 3.6&#43;. This system is running on a cloud instance of Ubuntu 16.04, which only supports Python up to 3.5.
Upgrading the server to Ubuntu 18.04 or 20.04 is out of the question. (Just the thought of someone typing `do-release-upgrade` in a production server makes me shiver&hellip;) Also, the system is from a pre-docker era, so no luck there." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://code.zoia.org/post/ubuntu-16-04-and-python-3-6/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-11-09T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-11-09T00:00:00+00:00" />


    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href='/css/styles.css'>
    <link rel="stylesheet" type="text/css" href='/css/syntax.css'>
</head>
<body>
        <div class="container max-w-screen-md mx-auto"><header class="container subpixel-antialiased">
    <nav class="flex flex-wrap w-full py-4 md:py-0 text-lg text-gray-70 bg-white">
        <ul class="text-base
                   text-gray-300
                   pt-4
                   md:flex
                   md:pt-0
                   sans-serif
                   uppercase
                   "
        >
            <li class="md:pt-3
                py-2
                block"><span class="
                                    font-medium
                                    text-lg
                                    text-gray-500"
                       >code</span><span
                            class="font-medium
                                   text-logoleft
                                   text-lg"
                        >zoia</span><span
                             class="
                                    text-lg
                                    font-medium
                                    text-gray-500"
                       >org</span></li>
            
                <li><a class="text-sm md:p-4 py-2 block hover:underline" href="/about/">About</a></li>
            
                <li><a class="text-sm md:p-4 py-2 block hover:underline" href="/archive/">Archive</a></li>
            
                <li><a class="text-sm md:p-4 py-2 block hover:underline" href="/">Home</a></li>
            

        </ul>
    </nav>
</header>
</div>
        <div class="content container max-w-screen-md mx-auto mt-8 pb-16">
    <article class="pb-4 mb-10">
        <header class="border-b">
            <h1 class="text-3xl font-sans font-normal">Ubuntu 16.04 and Python 3.6+</h1>
            <div class="text-sm text-gray-500">
    <time datetime='2021-11-09'>
        November 9, 2021
    </time>

    
        
        <a class="" href="https://code.zoia.org/tags/python-pyenv-openssl">Python, pyenv, openssl</a>
        
   
</div>

        </header>
        <div class="mt-3 font-sans font-light text-gray-900">
            <p>I was recently upgrading a system from Django 2.2 to 3.2. Django 3.2 requires Python 3.6+. This system is running on a cloud instance of Ubuntu 16.04, which only supports Python up to 3.5.</p>
<p>Upgrading the server to Ubuntu 18.04 or 20.04 is out of the question. (Just the thought of someone typing `do-release-upgrade` in a production server makes me shiver&hellip;) Also, the system is from a pre-docker era, so no luck there.</p>
<p>The cleanest way to run a more recent Python version is to install `<a href="https://github.com/pyenv/pyenv">pyenv`</a>. `pyenv` is a Python version management system which takes care of downloading, compiling, and installing the Python version you need without messing with the system configuration.</p>
<p>Python <a href="https://docs.python.org/release/3.10.0/whatsnew/changelog.html#python-3-10-0-final">now requires OpenSSL version 1.1.1+</a>, and Ubuntu 16.04 only provides OpenSSL up to version 1.0. So, if you try to install, for example, Python 3.10.0 using `pyenv`, you&rsquo;ll get an error complaining about OpenSSL. (The error is actually silent. You&rsquo;ll need to run `pyenv` with the verbose/-v in order to see the output.)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ pyenv install -v 3.10.0
<span style="color:#f92672">(</span>Several lines and minutes later...<span style="color:#f92672">)</span>
ERROR: The Python ssl extension was not compiled. Missing
the OpenSSL lib?
</code></pre></div><p>To fix this:</p>
<ol>
<li>
<p>Install OpenSSL 1.1.1 from <a href="https://www.openssl.org/source/">source</a>.</p>
<ul>
<li>Compile OpenSSL and install it.</li>
</ul>
<pre tabindex="0"><code>$ wget https://www.openssl.org/source/openssl-1.1.1l.tar.gz
$ tar xvfz openssl-1.1.1l.tar.gz
$ cd openssl-1-1-1l
$ ./config
$ make
$ sudo make install
</code></pre><ul>
<li>Add <code>/usr/local/lib</code> and <code>/usr/local/local/lib64</code> to your library path in <code>.bashrc</code> (or whatever your system uses) and reload your shell using <code>$ exec $SHELL</code>.</li>
</ul>
<pre tabindex="0"><code>export LD_LIBRARY_PATH=/usr/local/lib/:/usr/local/lib64:$LD_LIBRARY_PATH
</code></pre><ul>
<li>Check that OpenSSL installed OK:</li>
</ul>
<pre tabindex="0"><code>$ openssl version
OpenSSL 1.1.1l 24 Aug 2021
</code></pre></li>
<li>
<p>Tell <code>pyenv</code> where the OpenSSL files are located so the compiler and linker can find them. Then run <code>pyenv</code> to install the desired Python version.</p>
</li>
</ol>
<pre tabindex="0"><code>$ export LDFLAGS=&quot;-L/usr/local/lib/ -L/usr/local/lib64/&quot;
$ export CPPFLAGS=&quot;-I/usr/local/include -I/usr/local/include/openssl&quot;
$ export PYTHON_CONFIGURE_OPTS=&quot;--enable-shared&quot;
$ pyenv install -v 3.10.0
</code></pre><p>You should have now a working Python 3.10.0 that you can use with <code>pyenv</code>.</p>

        </div>
    </article>


        </div>
        <footer class="footer fixed inset-x-0 bottom-0 w-full bg-black text-gray-100 text-sm">
    <div class="container max-w-screen-md mx-auto pt-4 py-4">
        The footer.
    </div>
</footer>

    </body>
</html>
